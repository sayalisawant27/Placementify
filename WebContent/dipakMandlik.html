<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content=
		"width=device-width, initial-scale=1.0">

	<title>Get request</title>
</head>

<body>

	<input type="text" onblur="validateEmail(this.value)" id="mail" required></input>
	<button type="button" value="Compare" onclick="getData()">Submit</button>
	<div id="dataOutlet"></div>
	<script>
	function easyHTTP() {
		this.http = new XMLHttpRequest();
	}

	easyHTTP.prototype.get = function (url, callback) {
		this.http.open('GET', url, true);
		let self = this;
		this.http.onload = function () {
			if (self.http.status === 200) {
				callback(null, self.http.responseText);
			} else {
				callback('Error: ' + self.http.status);
			}
		}
		this.http.send();
	}
	
	function validateEmail(emailValue) {
		if (/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(emailValue))
		    return (true)
		else {
		   alert("You have entered an invalid email address!")
		   return (false)
		}
	}
	
	function getData() {
		const http = new easyHTTP;
		let inputField = document.getElementById('mail');
		var inputEmail = inputField.value;
		let dataOutletDiv = document.getElementById('dataOutlet');
		var dataStr = "";
		http.get('https://jsonplaceholder.typicode.com/users',
			function (err, users) {
				if (err) {
					console.log(err);
				} else {
					let data = JSON.parse(users);
					for (unitData in data) {
						if(inputEmail === data[unitData].email) {
							dataStr += "<h3>User with Given Email found!</h3><br>";
							dataStr += "<span>"+data[unitData].id+"</span><br>";
							dataStr += "<span>"+data[unitData].name+"</span><br>";
							dataStr += "<span>"+data[unitData].username+"</span><br>";
							dataStr += "<span>"+data[unitData].email+"</span><br>";
						};
					}
					dataOutletDiv.innerHTML = dataStr;
				}
			});
	}

	</script>
</body>

</html>
